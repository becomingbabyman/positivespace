<div id='space' class="container" centerish>
	<div class="row">
		<div class="span12">

			<div ng-show='user.can_edit' class="row pbm">
				<div class="span-mobile center">
					<div class='row-fluid'>
						<a href='#' class='btn btn-block btn-link btn-lrge bd circle' style='background: #fbfbfb;' ng-click='showShare = !showShare; showEmbed = !showEmbed; showEndorse = !showEndorse'>
							<i class='icon-group prs'></i>
							<ng-pluralize class="impressions" count='user.impressions_count' when="{1: '{} Visitor', 'other': '{} Visitors'}"></ng-pluralize>
							&middot;
							Share your space
						</a>
					</div>
				</div>
			</div>


			<div ng-show='user.can_edit && showShare' class="row">
				<div class="span-mobile center">
					<div class='row-fluid'>
						<div class="span12 alert alert-info alert-block uncenter bgw">
							<button type="button" class="close" ng-click="showShare = false">&times;</button>
							<h4>1. Start a conversation</h4>
							Share your space with the people you want to have a conversation with.
							<!-- AddThis Button BEGIN -->
							<div class="addthis_toolbox addthis_default_style ptm">
								<a class="addthis_button_facebook"></a>
								<a class="addthis_button_twitter"></a>
								<a class="addthis_button_google_plusone_share"></a>
								<a class="addthis_button_email"></a>
								<a href="http://addthis.com/bookmark.php?v=250" class="addthis_button_compact"></a>
								<a class="addthis_button_facebook_send" style='margin-top: -3px;'></a>
							</div>
							<!-- AddThis Button END -->
						</div>
					</div>
				</div>
			</div>


			<div ng-show='user.can_edit && showEmbed' class="row" ng-class='{ptl: showShare}'>
				<div class="span-mobile center">
					<div class='row-fluid'>
						<div class="span12 alert alert-info alert-block uncenter bgw">
							<button type="button" class="close" ng-click="showEmbed = false">&times;</button>
							<h4>2. Embed your space</h4>
							Let conversations come to you. Embed your space in your website or blog.
							<a href="#" ng-click="requestEmbedCode()" class="btn btn-link btn-block">Click to get embed code</a>
						</div>
					</div>
				</div>
			</div>


			<div ng-show='user.can_edit && user.state == "unendorsed" && showEndorse' class="row" ng-class='{ptl: (showShare || showEmbed)}'>
				<div class="span-mobile center">
					<div class='row-fluid'>
						<div class="span12 alert alert-info alert-block uncenter bgw">
							<button type="button" class="close" ng-click="showEndorse = false">&times;</button>
							<h4>3. Publish your space</h4>
							Make you space public and discoverable to everyone using Positive Space. You must be endorsed by one published person.
							<a href="#" ng-click="requestEndorsement()" class="btn btn-info btn-block">Request an endorsement</a>
						</div>
					</div>
				</div>
			</div>


			<div ng-show='user.can_edit' class="row">
				<div class="span-mobile center ptm">
					<a ng-href='/{{user.slug}}/edit' class='pull-right btn btn-link btn-large' title='change your space'>edit</a>
				</div>
			</div>


			<div class="row ptm">
				<div class="span-mobile center pos-rel">
					<!-- <div class='lbl ptx'>To:</div> -->

					<div class="center animated fadeInDown">
						<div class='uncenter row-fluid font22'>
							<a href="#" class='faded plm pull-right opacity6 opacity-full-hover' title='follow' ng-hide='user.has_follow' ng-click='social("follow")'>
								<i class='icon-bookmark-empty'></i>
							</a>
							<a href="#" class='plm pull-right opacity6 opacity-full-hover' title='unfollow' ng-show='user.has_follow' ng-click='social("unfollow")'>
								<i class='icon-bookmark color-green'></i>
							</a>

							<a href="#" class='faded plm pull-right opacity6 opacity-full-hover' title='like' ng-hide='user.has_like' ng-click='social("like")'>
								<i class='icon-star-empty'></i>
							</a>
							<a href="#" class='plm pull-right opacity6 opacity-full-hover' title='unlike' ng-show='user.has_like' ng-click='social("unlike")'>
								<i class='icon-star color-yellow'></i>
							</a>

							<a href="#" class='faded prm pull-left opacity6 opacity-full-hover' ng-show='user.state == "unendorsed"' tooltip='Endorse this space - you have ({{app.currentUser.invitation_count}}) remaining' ng-show='user.state == "unendorsed"' tooltip-placement='right'>
								<i class='icon-heart-empty'></i>
							</a>
							<a href="#" class='faded prm pull-left opacity6 opacity-full-hover' title='endorsed by {{user.invitation.user.name}}' ui-if='user.state != "unendorsed"'>
								<i class='icon-heart'></i>
							</a>
							<!-- <i class='icon-bolt faded prm pull-left' title=''></i> -->
						</div>
						<ps-img src="{{user.avatar.big_thumb_url}}" alt="{{user.name}}" img-class="img-circle img-border img-big-thumb"></ps-img>

						<div class='animated fadeInDown'>
							<h2 class='pts pbs'>{{user.name}}</h2>
							<p ng-bind-html-unsafe="user.body | linebreaks" class='prompt'>{{user.body}}</p>

							<!-- <div class='ptl'>
								<i class='icon-certificate faded prm' title='verified account'></i>
								<i class='icon-rss faded prm'></i>
								<i class='icon-trophy faded prm'></i>
								<i class='icon-money faded prm'></i>
								<i class='icon-group faded prm'></i>
								<i class='icon-facebook faded prm'></i>
								<i class='icon-twitter faded prm'></i>
								<i class='icon-github faded prm'></i>
								<i class='icon-linkedin faded prm'></i>
								<i class='icon-pinterest faded prm'></i>
								<i class='icon-google-plus faded'></i>
							</div> -->

							<div ng-show='user.location.length > 0 || user.personal_url.length > 0' class='m0 ptl'>
								<div ng-show='user.location.length > 0'>
									<i class='icon-map-marker faded'></i>
									<br/>
									<strong>{{user.location}}</strong>
								</div>
								<div ng-show='user.personal_url.length > 0'><a href='{{user.personal_url}}' target='_blank' class='unfancy-link underline'>{{user.personal_url | urlSimplify}}</a></div>
							</div>
						</div>
					</div>

				</div>
			</div>


			<div class='row animated fadeInUp ptl' ng-hide="conversation && conversation.prompt == user.body">
				<div class="span-mobile center pos-rel">
					<form name='messageForm' class='form-vertical uncenter' ng-submit='submitMessage()' novalidate style='width: 100%;'>

						<!-- <div class='lbl ptx'>From:</div> -->

						<ps-subtle-login app='app'></ps-subtle-login>

						<control-group>
							<textarea name='body' id='msg_body' title='message body' placeholder="message{{' to ' + user.name | lowercase}}" class='input-block-level' ng-model='message.body' rows=5 required ng-disabled='message.id'></textarea>
						</control-group>

						<div ng-show='show.embedInput'>
							<control-group>
								<input type="url" name='embed_url' id='msg_embed_url' title='embed url' placeholder='http://example.com' class='input-block-level' ng-model='message.embed_url' ng-disabled='message.id'>
							</control-group>
						</div>

						<div class='control-group'>
							<div class='controls'>
								<a href='#' class='muted' ng-click='show.embedInput = true' ng-hide='show.embedInput'><i class='icon-link pts font20' tooltip='Attach a link. We will magically find and embed picture, video, audio, and more.' tooltip-placement='right'></i></a>
								<a href='#' class='muted' ng-click='show.embedInput = false' ng-show='show.embedInput'><i class='icon-link pts font20'></i></a>

								<button ng-hide='message.id' type='submit' class='btn btn-success pull-right' ng-disabled="messageForm.body.$invalid">Start Conversation</button>
								<button ng-show='message.id' type='submit' class='btn btn-disabled pull-right' disabled>Message Sent</button>

								<span class='pull-right pts prm' id='msg_remaining_chars' ng-class='{"muted": remainingChars > 10, "text-error": remainingChars <= 10}'>{{remainingChars}}</span>
							</div>
						</div>

					</form>
				</div>
			</div>


			<div class='row animated fadeInUp ptl' ng-show="conversation && conversation.prompt == user.body">
				<div class="span-mobile center">
					<div class='well'>
						You are already engaged in a conversation about this exact topic
					</div>
				</div>
			</div>


			<div class='row animated fadeInUp ptl' ng-show="conversation">
				<div class="span-mobile center">
					<a ng-href="/conversations/{{conversation.id}}?message_id={{conversation.last_message_id}}" class='unfancy-link'>
						<div class='btn btn-block circle'>
							Go to conversation
						</div>
						<div class="row-fluid ptl">
							<div class="span1">
								-
							</div>
							<div class="span11">
								<p class='font18 uncenter' ng-bind-html-unsafe="conversation.last_message_body | linebreaks">{{conversation.last_message_body}}</p>
							</div>
						</div>
						<div class="row-fluid" ng-show="conversation.state != 'ended' && conversation.last_message_from_id != app.currentUser.id">
							<div class="span12">
								<div class='btn btn-link btn-block' ng-click='selectConversation(conversation)'>reply</div>
							</div>
						</div>
					</a>
				</div>
			</div>

		</div>
	</div>
</div>
