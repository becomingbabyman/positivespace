<div id='space' class="container" centerish>
	<div class="row">
		<div class="span12">

			<div ng-show='user.can_edit' class="row">
				<div class="span-mobile center">
					<a ng-hide='space.editing' ng-click='space.editing = true' class='pull-right btn btn-link'>edit</a>
					<edit-resource app='app', toggle='openUserEdit', resource='user'></edit-resource>
				</div>
			</div>

			<div class="row">
				<div class="span-mobile center pos-rel">
					<div class='lbl ptx'>To:</div>

					<div class="center" ng-class='{"animated fadeInDown": !space.editing, "animated fadeInDown": space.editing}'>
						<ps-img src="{{user.avatar.big_thumb_url}}" alt="{{user.name}}" img-class="img-circle img-border img-big-thumb" attachable-type='User' attachable-id='{{user.id}}' image-type='avatar' image-url='big_thumb_url' can-edit='{{user.id && user.id == app.currentUser.id}}'></ps-img>
						<div ng-hide='space.editing' ng-class='{"animated fadeInDown": !space.editing, "animated fadeOutUp": space.editing}'>
							<h2>{{user.name}}</h2>
							<br/>
							<p ng-bind-html-unsafe="user.body | linebreaks">{{user.body}}</p>
							<br ng-show='user.location.length > 0 || user.personal_url.length > 0'/>
							<p ng-show='user.location.length > 0 || user.personal_url.length > 0'>
								<span ng-show='user.location.length > 0'><i class='icon-map-marker'></i> {{user.location}}</span>
								<span ng-show='user.location.length > 0 && user.personal_url.length > 0'>&nbsp;&middot;&nbsp;</span>
								<span ng-show='user.personal_url.length > 0'><a href='{{user.personal_url}}' target='_blank' class='unfancy-link'>{{user.personal_url | urlSimplify}}</a></span>
							</p>
							<br/>
						</div>
					</div>

					<form ng-show='space.editing' ng-class='{"animated fadeInUp": space.editing, "animated fadeOutUp": !space.editing}' name='user_profile' class='form-vertical uncenter ptl' ng-submit='saveSpace()' novalidate style='width: 100%;'>

						<control-group label='Full name'>
							<input name='name' id='user_name' title='your real name (not your username)' placeholder="your full name" class='input-block-level' ng-model='userCopy.name' required></input>
						</control-group>

						<control-group label="Today's conversation starter" help-block='What one thing would you like to talk about right now?'>
							<textarea name='body' id='user_body' title='the one thing you want to talk about' placeholder="I want to talk about JUST ONE THING, which is... " class='input-block-level' ng-model='userCopy.body' rows=5 required></textarea>
						</control-group>

						<div class="row-fluid">
							<div class="span6">
								<control-group label='Location'>
								    <input type='text' id='user_location' name='location' title='your current location' placeholder='City, State' class='input-block-level' ng-model='userCopy.location' ng-maxlength='140'></input>
								</control-group>
							</div>

							<div class="span6">
								<control-group label='Website'>
					                <input type='url' id='user_personal_url' name='personal_url' title='link to your website' placeholder='http://example.com' class='input-block-level' ng-model='userCopy.personal_url' ng-maxlength='800'></input>
					            </control-group>
							</div>
						</div>

						<div class='control-group'>
							<div class='controls'>
								<button type='submit' class='btn btn-success pull-right'>Update your space</button>
								<span class='pull-right pts prm' ng-class='{"muted": userBodyRemaining > 10, "text-error": userBodyRemaining <= 10}'>{{userBodyRemaining}}</span>
								<a ng-hide='space.cantCloseEdit' ng-click='space.editing = false' class='btn btn-link'>close</a>
							</div>
						</div>

					</form>

				</div>
			</div>

			<div ng-hide='space.editing' ng-class='{"animated fadeInUp": !space.editing, "animated fadeOutDown": space.editing}' class="row">
				<div class="span-mobile center pos-rel">
					<form name='messageForm' class='form-vertical uncenter' ng-submit='submitMessage()' novalidate style='width: 100%;'>

						<div class='lbl ptx'>From:</div>
						<ps-subtle-login app='app'></ps-subtle-login>

						<control-group>
							<textarea name='body' id='msg_body' title='message body' placeholder="message{{' to ' + user.name | lowercase}}" class='input-block-level' ng-model='message.body' rows=5 required></textarea>
						</control-group>

						<div class='control-group'>
							<div class='controls'>
								<button ng-hide='message.id' type='submit' class='btn btn-success pull-right' ng-disabled="messageForm.body.$invalid">Start Conversation</button>
								<button ng-show='message.id' type='submit' class='btn btn-disabled pull-right' disabled>Message Sent</button>
								<span class='pull-right pts prm' id='msg_remaining_chars' ng-class='{"muted": remainingChars > 10, "text-error": remainingChars <= 10}'>{{remainingChars}}</span>
							</div>
						</div>

					</form>
				</div>
			</div>

		</div>
	</div>
</div>
